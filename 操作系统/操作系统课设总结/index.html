<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" title="澹台千儿" href="http://tantaiqianer.github.io/rss.xml"><link rel="alternate" type="application/atom+xml" title="澹台千儿" href="http://tantaiqianer.github.io/atom.xml"><link rel="alternate" type="application/json" title="澹台千儿" href="http://tantaiqianer.github.io/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><link rel="canonical" href="http://tantaiqianer.github.io/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E8%AF%BE%E8%AE%BE%E6%80%BB%E7%BB%93/"><title>操作系统课设总结 - 操作系统 - 计算机 | Tantai Qianer = 澹台千儿</title><meta name="generator" content="Hexo 6.0.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">操作系统课设总结</h1><div class="meta"><span class="item" title="创建时间：2022-10-06 00:00:00"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">发表于</span> <time itemprop="dateCreated datePublished" datetime="2022-10-06T00:00:00+08:00">2022-10-06</time> </span><span class="item" title="本文字数"><span class="icon"><i class="ic i-pen"></i> </span><span class="text">本文字数</span> <span>11k</span> <span class="text">字</span> </span><span class="item" title="阅读时长"><span class="icon"><i class="ic i-clock"></i> </span><span class="text">阅读时长</span> <span>10 分钟</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="切换导航栏"><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">Tantai Qianer</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><ul><li class="item" data-background-image="https://img.timelessq.com/image/ND9J"></li><li class="item" data-background-image="https://img.timelessq.com/image/CceY"></li><li class="item" data-background-image="https://img.timelessq.com/image/qLg8"></li><li class="item" data-background-image="https://img.timelessq.com/image/3uc"></li><li class="item" data-background-image="https://img.timelessq.com/image/qSve"></li><li class="item" data-background-image="https://img.timelessq.com/image/fOJ"></li></ul></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">首页</a></span><i class="ic i-angle-right"></i> <span itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA/" itemprop="item" rel="index" title="分类于 计算机"><span itemprop="name">计算机</span></a><meta itemprop="position" content="1"></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/" itemprop="item" rel="index" title="分类于 操作系统"><span itemprop="name">操作系统</span></a><meta itemprop="position" content="2"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="http://tantaiqianer.github.io/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E8%AF%BE%E8%AE%BE%E6%80%BB%E7%BB%93/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="澹台千儿"><meta itemprop="description" content=", "></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="澹台千儿"></span><div class="body md" itemprop="articleBody"><h1 id="概述"><a class="anchor" href="#概述">#</a> 概述</h1><p>这是关于操作系统课设的一个简单总结。课设内容为完成<span class="exturl" data-url="aHR0cHM6Ly9wZG9zLmNzYWlsLm1pdC5lZHUvNi44MjgvMjAyMS9pbmRleC5odG1s"> MIT: 6.s081-2021</span> 的相关实验。</p><h1 id="lab-xv6-and-unix-utilities"><a class="anchor" href="#lab-xv6-and-unix-utilities">#</a> Lab: Xv6 and Unix utilities</h1><p><span class="exturl" data-url="aHR0cHM6Ly9wZG9zLmNzYWlsLm1pdC5lZHUvNi44MjgvMjAyMS9sYWJzL3V0aWwuaHRtbA==">Lab: Xv6 and Unix utilities</span> 是 6.s081 系列的第一组实验，其目标是调用部分系统调用，实现部分程序要求。</p><h2 id="sleep-easy"><a class="anchor" href="#sleep-easy">#</a> sleep (easy)</h2><p>关于 <code>sleep</code> 的任务要求原文如下：</p><blockquote><p>Implement the UNIX program <code>sleep</code> for xv6; your sleep should pause for a user-specified number of ticks. A tick is a notion of time defined by the xv6 kernel, namely the time between two interrupts from the timer chip. Your solution should be in the file <code>user/sleep.c</code> .</p><p>Some hints:</p><ul><li>Before you start coding, read Chapter 1 of the <span class="exturl" data-url="aHR0cHM6Ly9wZG9zLmNzYWlsLm1pdC5lZHUvNi44MjgvMjAyMS94djYvYm9vay1yaXNjdi1yZXYyLnBkZg==">xv6 book</span>.</li><li>Look at some of the other programs in <code>user/</code> (e.g., <code>user/echo.c</code> , <code>user/grep.c</code> , and <code>user/rm.c</code> ) to see how you can obtain the command-line arguments passed to a program.</li><li>If the user forgets to pass an argument, sleep should print an error message.</li><li>The command-line argument is passed as a string; you can convert it to an integer using <code>atoi</code> (see <code>user/ulib.c</code> ).</li><li>Use the system call <code>sleep</code> .</li><li>See <code>kernel/sysproc.c</code> for the xv6 kernel code that implements the <code>sleep</code> system call (look for <code>sys_sleep</code> ), <code>user/user.h</code> for the C definition of <code>sleep</code> callable from a user program, and <code>user/usys.S</code> for the assembler code that jumps from user code into the kernel for <code>sleep</code> .</li><li>Make sure <code>main</code> calls <code>exit()</code> in order to exit your program.</li><li>Add your <code>sleep</code> program to <code>UPROGS</code> in Makefile; once you've done that, make qemu will compile your program and you'll be able to run it from the xv6 shell.</li><li>Look at Kernighan and Ritchie's book <span class="exturl" data-url="aHR0cHM6Ly9uZWlsa2xpbmdlbnNtaXRoLmNvbS90ZWFjaGluZy9sb3lvbGEvY3MyNjQtczIwMjAvcmVhZGluZ3MvY2Jvb2sucGRm">The C programming language (second edition)</span> (K&amp;R) to learn about C.</li></ul></blockquote><h2 id="xargs-moderate"><a class="anchor" href="#xargs-moderate">#</a> xargs (moderate)</h2><p><code>xargs</code> 是 Linux 中的一个重要指令，用来实现标准输入和文件输入的格式转换，以及输入参数的整合。其命令格式如下：</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre>somecommand <span class="token operator">|</span><span class="token function">xargs</span> <span class="token parameter variable">-item</span> <span class="token builtin class-name">command</span></pre></td></tr></table></figure><h1 id="lab-system-calls"><a class="anchor" href="#lab-system-calls">#</a> Lab: system calls</h1><p><span class="exturl" data-url="aHR0cHM6Ly9wZG9zLmNzYWlsLm1pdC5lZHUvNi44MjgvMjAyMS9sYWJzL3N5c2NhbGwuaHRtbA==">Lab: system calls</span> 是 6.s081 系列的第二组实验，其目标是设计一些系统调用，以深入了解 xv6 内核中的系统调用规则及实现。</p><h2 id="system-call-tracing"><a class="anchor" href="#system-call-tracing">#</a> System call tracing</h2><blockquote><p>In this assignment you will add a system call <strong>tracing</strong> feature that may help you when debugging later labs. You'll create a new trace system call that will control tracing. It should take one argument, an integer &quot;mask&quot;, whose bits specify which system calls to trace. For example, to trace the fork system call, a program calls <code>trace(1 &lt;&lt; SYS_fork)</code> , where <code>SYS_fork</code> is a syscall number from <code>kernel/syscall.h</code> . You have to modify the xv6 kernel to print out a line when each system call is about to return, if the system call's number is set in the mask. The line should contain the process id, the name of the system call and the return value; you don't need to print the system call arguments. The trace system call should enable tracing for the process that calls it and any children that it subsequently forks, but should not affect other processes.</p><p>Some hints:</p><ul><li>Add <code>$U/_trace</code> to <code>UPROGS</code> in Makefile.</li><li>Run <code>make qemu</code> and you will see that the compiler cannot compile <code>user/trace.c</code> , because the user-space stubs for the system call don't exist yet: add a prototype for the system call to <code>user/user.h</code> , a stub to <code>user/usys.pl</code> , and a syscall number to <code>kernel/syscall.h</code> . The Makefile invokes the perl script <code>user/usys.pl</code> , which produces <code>user/usys.S</code> , the actual system call stubs, which use the RISC-V <code>ecall</code> instruction to transition to the kernel. Once you fix the compilation issues, run <code>trace 32 grep hello README</code> ; it will fail because you haven't implemented the system call in the kernel yet.</li><li>Add a <code>sys_trace()</code> function in <code>kernel/sysproc.c</code> that implements the new system call by remembering its argument in a new variable in the <code>proc</code> structure (see <code>kernel/proc.h</code> ). The functions to retrieve system call arguments from user space are in <code>kernel/syscall.c</code> , and you can see examples of their use in <code>kernel/sysproc.c</code> .</li><li>Modify <code>fork()</code> (see <code>kernel/proc.c</code> ) to copy the trace mask from the parent to the child process.</li><li>Modify the <code>syscall()</code> function in <code>kernel/syscall.c</code> to print the trace output. You will need to add an array of syscall names to index into.</li></ul></blockquote><p>完成步骤：(主要参考<span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xod2hpdC9hcnRpY2xlL2RldGFpbHMvMTE2NDgyODA2"> lhw---9999: xv6 实验课程 -- 系统调用</span>)</p><ol><li>在 <code>Makefile</code> 的 <code>UPROGS</code> 项中加入 <code>$U/_trace\</code> .</li><li>包括以下步骤：<ol><li>在系统调用头文件 <code>user/user.h</code> 中加入 <code>int trace(uint);</code></li><li>在 Perl 脚本 <code>user/usys.pl</code> 中加入 <code>entry(&quot;trace&quot;);</code> 作为动态链接的调用入口 (存根，stub).</li><li>在 <code>kernel/syscall.h</code> 中加入系统调用号 <code>#define SYS_trace 22</code> .</li></ol></li><li>在 <code>kernel/sysproc.c</code> 中加入函数 <code>sys_trace()</code> . 注意需要自定义数组 <code>char* syscall_name[24]</code> , 在定义时需要将数组范围开大一点。</li></ol><h2 id="sysinfo"><a class="anchor" href="#sysinfo">#</a> Sysinfo</h2><blockquote><p>In this assignment you will add a system call, <code>sysinfo</code> , that collects information about the running system. The system call takes one argument: a pointer to a <code>struct sysinfo</code> (see <code>kernel/sysinfo.h</code> ). The kernel should <strong>fill out the fields of this struct</strong>: the <code>freemem</code> field should <strong>be set to the number of bytes of free memory</strong>, and the <code>nproc</code> field should <strong>be set to the number of processes</strong> whose <code>state</code> is not <code>UNUSED</code> . We provide a test program <code>sysinfotest</code> ; you pass this assignment if it prints &quot;sysinfotest: OK&quot;.</p><p>Some hints:</p><ul><li>Add <code>$U/_sysinfotest\</code> to <code>UPROGS</code> in Makefile</li><li>Run <code>make qemu</code> ; <code>user/sysinfotest.c</code> will fail to compile. Add the system call <code>sysinfo</code> , following the same steps as in the previous assignment. To declare the prototype for <code>sysinfo()</code> in <code>user/user.h</code> you need predeclare the existence of struct sysinfo:</li></ul><figure class="highlight c"><figcaption data-lang="c"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">struct</span> <span class="token class-name">sysinfo</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre> <span class="token keyword">int</span> <span class="token function">sysinfo</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">sysinfo</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><ul><li>Once you fix the compilation issues, run <code>sysinfotest</code> ; it will fail because you haven't implemented the system call in the kernel yet.</li><li>sysinfo needs to copy a struct sysinfo back to user space; see <code>sys_fstat()</code> ( <code>kernel/sysfile.c</code> ) and <code>filestat()</code> ( <code>kernel/file.c</code> ) for examples of how to do that using <code>copyout()</code> .</li><li>To collect the amount of free memory, add a function to <code>kernel/kalloc.c</code></li><li>To collect the number of processes, add a function to <code>kernel/proc.c</code></li></ul></blockquote><h1 id="lab-page-tables"><a class="anchor" href="#lab-page-tables">#</a> Lab: page tables</h1><p><span class="exturl" data-url="aHR0cHM6Ly9wZG9zLmNzYWlsLm1pdC5lZHUvNi44MjgvMjAyMS9sYWJzL3BndGJsLmh0bWw=">Lab: page tables</span> 是 6.s081 系列第三组实验，其目的是掌握页表的相关内容。</p><h2 id="speed-up-system-calls-easy"><a class="anchor" href="#speed-up-system-calls-easy">#</a> Speed up system calls (easy)</h2><p>一些操作系统通过在内核和用户空间之间的部分只读区域进行数据共享，以加快系统调用速度。这样做可以避免调用不同系统调用产生跨内核现象。</p><p>第一个实验需要实现系统调用 <code>getpid()</code> 的优化，从而帮助更好理解如何在页表中插入映射。</p><div class="note info"><p><code>pid</code> 位于 <code>kernel/memlayout.h</code> 中。</p></div><blockquote><p>When each process is created, map one read-only page at USYSCALL (a VA defined in <code>memlayout.h</code> ). At the start of this page, store a <code>struct usyscall</code> (also defined in <code>memlayout.h</code> ), and initialize it to store the PID of the current process. For this lab, <code>ugetpid()</code> has been provided on the userspace side and will automatically use the USYSCALL mapping. You will receive full credit for this part of the lab if the <code>ugetpid</code> test case passes when running <code>pgtbltest</code> .</p><p>Some hints:</p><ul><li>You can perform the mapping in <code>proc_pagetable()</code> in <code>kernel/proc.c</code> .</li><li>Choose permission bits that allow userspace to only read the page.</li><li>You may find that <code>mappages()</code> is a useful utility.</li><li>Don't forget to allocate and initialize the page in <code>allocproc()</code> .</li><li>Make sure to free the page in <code>freeproc()</code> .</li></ul></blockquote><p>&lt;img src=&quot;../../images/OS/lab01.png&quot; alt=&quot;&quot; style=&quot;zoom:80%;&quot; /&gt;</p><p>在 <code>kernel/vm.c</code> 中的函数声明如下 (见 <code>kernel/defs.h</code> )：</p><figure class="highlight c"><figcaption data-lang="c"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">void</span>            <span class="token function">kvminit</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">void</span>            <span class="token function">kvminithart</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">void</span>            <span class="token function">kvmmap</span><span class="token punctuation">(</span><span class="token class-name">pagetable_t</span><span class="token punctuation">,</span> uint64<span class="token punctuation">,</span> uint64<span class="token punctuation">,</span> uint64<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">int</span>             <span class="token function">mappages</span><span class="token punctuation">(</span><span class="token class-name">pagetable_t</span><span class="token punctuation">,</span> uint64<span class="token punctuation">,</span> uint64<span class="token punctuation">,</span> uint64<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token class-name">pagetable_t</span>     <span class="token function">uvmcreate</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">void</span>            <span class="token function">uvminit</span><span class="token punctuation">(</span><span class="token class-name">pagetable_t</span><span class="token punctuation">,</span> uchar <span class="token operator">*</span><span class="token punctuation">,</span> uint<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>uint64          <span class="token function">uvmalloc</span><span class="token punctuation">(</span><span class="token class-name">pagetable_t</span><span class="token punctuation">,</span> uint64<span class="token punctuation">,</span> uint64<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>uint64          <span class="token function">uvmdealloc</span><span class="token punctuation">(</span><span class="token class-name">pagetable_t</span><span class="token punctuation">,</span> uint64<span class="token punctuation">,</span> uint64<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">int</span>             <span class="token function">uvmcopy</span><span class="token punctuation">(</span><span class="token class-name">pagetable_t</span><span class="token punctuation">,</span> <span class="token class-name">pagetable_t</span><span class="token punctuation">,</span> uint64<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">void</span>            <span class="token function">uvmfree</span><span class="token punctuation">(</span><span class="token class-name">pagetable_t</span><span class="token punctuation">,</span> uint64<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token keyword">void</span>            <span class="token function">uvmunmap</span><span class="token punctuation">(</span><span class="token class-name">pagetable_t</span><span class="token punctuation">,</span> uint64<span class="token punctuation">,</span> uint64<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token keyword">void</span>            <span class="token function">uvmclear</span><span class="token punctuation">(</span><span class="token class-name">pagetable_t</span><span class="token punctuation">,</span> uint64<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>uint64          <span class="token function">walkaddr</span><span class="token punctuation">(</span><span class="token class-name">pagetable_t</span><span class="token punctuation">,</span> uint64<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token keyword">int</span>             <span class="token function">copyout</span><span class="token punctuation">(</span><span class="token class-name">pagetable_t</span><span class="token punctuation">,</span> uint64<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">,</span> uint64<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">int</span>             <span class="token function">copyin</span><span class="token punctuation">(</span><span class="token class-name">pagetable_t</span><span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">,</span> uint64<span class="token punctuation">,</span> uint64<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token keyword">int</span>             <span class="token function">copyinstr</span><span class="token punctuation">(</span><span class="token class-name">pagetable_t</span><span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">,</span> uint64<span class="token punctuation">,</span> uint64<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token class-name">pte_t</span> <span class="token operator">*</span>         <span class="token function">walk</span><span class="token punctuation">(</span><span class="token class-name">pagetable_t</span> pagetable<span class="token punctuation">,</span> uint64 va<span class="token punctuation">,</span> <span class="token keyword">int</span> alloc<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>其中比较关键的包括：</p><ol><li><code>void kvmmap</code> : 在装入程序时添加一个内核页表。</li><li><code>void uvminit</code> : 对页表首地址进行初始化。</li><li><code>pte_t walk()</code> : 返回页表中 PTE 的地址。</li></ol><p>步骤：</p><h2 id="print-a-page-table-easy"><a class="anchor" href="#print-a-page-table-easy">#</a> Print a page table (easy)</h2><p>要求和提示如下：</p><blockquote><p>Define a function called vmprint(). It should take a pagetable_t argument, and print that pagetable in the format described below. Insert if(p-&gt;pid==1) vmprint(p-&gt;pagetable) in exec.c just before the return argc, to print the first process's page table. You receive full credit for this part of the lab if you pass the pte printout test of make grade.</p><p>Some hints:</p><ul><li>You can put <code>vmprint()</code> in <code>kernel/vm.c</code> .</li><li>Use the macros at the end of the file kernel/riscv.h.</li><li>The function freewalk may be inspirational.</li><li>Define the prototype for vmprint in kernel/defs.h so that you can call it from exec.c.</li><li>Use %p in your printf calls to print out full 64-bit hex PTEs and addresses as shown in the example.</li></ul></blockquote><h2 id="detecting-which-pages-have-been-accessed-hard"><a class="anchor" href="#detecting-which-pages-have-been-accessed-hard">#</a> Detecting which pages have been accessed (hard)</h2><p>In this part of the lab, you will <strong>add a new feature to xv6 that detects and reports this information to userspace by inspecting the access bits in the RISC-V page table</strong>. The RISC-V hardware page walker marks these bits in the PTE whenever it resolves a TLB miss.</p><p>即要求在页表中新加入一个标志位，用来检测该页表的获取情况。</p><p>要求和提示如下：</p><blockquote><p>Your job is to implement pgaccess(), a system call that reports which pages have been accessed. The system call takes three arguments. First, it takes the starting virtual address of the first user page to check. Second, it takes the number of pages to check. Finally, it takes a user address to a buffer to store the results into a bitmask (a datastructure that uses one bit per page and where the first page corresponds to the least significant bit). You will receive full credit for this part of the lab if the pgaccess test case passes when running pgtbltest.</p></blockquote><p>对应的提示如下：</p><blockquote><ul><li>Start by implementing <code>sys_pgaccess()</code> in <code>kernel/sysproc.c</code> .</li><li>You'll need to parse arguments using <code>argaddr()</code> and <code>argint()</code> .</li></ul><div class="note info"><p><code>int argaddr(int n, uint64 *ip)</code> 将一个参数检索为一个指针，而不检验指针合法性。</p><p><code>int argint(int n, int *ip)</code> : 获取第 n 个 32 位系统调用参数。</p></div><ul><li>For the output bitmask, it's easier to store a temporary buffer in the kernel and copy it to the user (via <code>copyout()</code> ) after filling it with the right bits.</li><li>It's okay to set an upper limit on the number of pages that can be scanned.</li><li><code>walk()</code> in <code>kernel/vm.c</code> is very useful for <strong>finding the right PTEs</strong>.</li><li>You'll need to define PTE_A, the access bit, in <code>kernel/riscv.h</code> . Consult the RISC-V manual to determine its value.</li><li>Be sure to clear PTE_A after checking if it is set. Otherwise, it won't be possible to determine if the page was accessed since the last time <code>pgaccess()</code> was called (i.e., the bit will be set forever).</li><li><code>vmprint()</code> may come in handy to debug page tables.</li></ul></blockquote><p>步骤：</p><ol><li>首先需要在 PTE 中定义一个标志位 <code>PTE_A</code> 表示当前 PTE 是否已经被获取 (hint 6)。</li><li>在 <code>kernel/sysproc.c</code> 中完成程序：<ol><li>采用 <code>argaddr()</code> 及 <code>argint()</code> 解析参数</li></ol></li></ol><p>&lt;img src=&quot;../../images/OS/lab02.png&quot; alt=&quot;&quot; style=&quot;zoom:80%;&quot; /&gt;</p><h1 id="lab-traps"><a class="anchor" href="#lab-traps">#</a> Lab: Traps</h1><h2 id="alarmhard"><a class="anchor" href="#alarmhard">#</a> Alarm(hard)</h2><p>目的是实现一个新的系统调用 <code>sigalarm(interval, handler)</code> , 其中 <code>interval</code> 表示 alarm 周期， <code>handler</code> 是一个函数指针。</p><h3 id="test0-invoke-handler"><a class="anchor" href="#test0-invoke-handler">#</a> Test0 invoke handler</h3><p>下面是一些提示：</p><blockquote><ul><li>You'll need to modify the Makefile to cause <code>alarmtest.c</code> to be compiled as an xv6 user program.</li><li>The right declarations to put in user/user.h are:</li></ul><figure class="highlight c"><figcaption data-lang="c"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">int</span> <span class="token function">sigalarm</span><span class="token punctuation">(</span><span class="token keyword">int</span> ticks<span class="token punctuation">,</span> <span class="token keyword">void</span> <span class="token punctuation">(</span><span class="token operator">*</span>handler<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    <span class="token keyword">int</span> <span class="token function">sigreturn</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><ul><li>Update <code>user/usys.pl</code> (which generates <code>user/usys.S</code> ), <code>kernel/syscall.h</code> , and <code>kernel/syscall.c</code> to allow <code>alarmtest</code> to invoke the <code>sigalarm</code> and <code>sigreturn</code> system calls.</li><li>For now, your <code>sys_sigreturn</code> should just return zero.</li><li>Your <code>sys_sigalarm()</code> should store <strong>the alarm interval</strong> and <strong>the pointer to the handler function</strong> in new fields in the <code>proc</code> structure (in <code>kernel/proc.h</code> ).</li><li>You'll need to keep track of <strong>how many ticks have passed since the last call</strong>(defined as <code>ticks</code> in <code>proc.h</code> ) to a process's alarm handler; you'll need a new field in struct proc for this too. You can initialize proc fields in <code>allocproc()</code> in <code>proc.c</code> .(OK)</li><li>Every tick, the hardware clock forces an interrupt, which is handled in <code>usertrap()</code> in <code>kernel/trap.c</code> .</li><li>You only want to manipulate a process's alarm ticks if there's a timer interrupt; you want something like</li></ul><figure class="highlight c"><figcaption data-lang="c"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span>which_dev <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span></pre></td></tr></table></figure><ul><li>Only invoke the alarm function if the process has a timer outstanding. Note that the address of the user's alarm function might be 0 (e.g., in <code>user/alarmtest.asm</code> , <code>periodic</code> is at address 0). ????</li><li>You'll need to modify <code>usertrap()</code> so that when a process's alarm interval expires, the user process executes the handler function. When a trap on the RISC-V returns to user space, what determines the instruction address at which user-space code resumes execution?</li><li>It will be easier to look at traps with gdb if you tell qemu to use only one CPU, which you can do by running</li></ul><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token function">make</span> <span class="token assign-left variable">CPUS</span><span class="token operator">=</span><span class="token number">1</span> qemu-gdb</pre></td></tr></table></figure><ul><li>You've succeeded if alarmtest prints &quot;alarm!&quot;.</li></ul></blockquote><h3 id="test1test2-resume-interrupted-code"><a class="anchor" href="#test1test2-resume-interrupted-code">#</a> Test1/test2(): resume interrupted code</h3><p>又是一些 hints:</p><blockquote><ul><li>Your solution will require you to save and restore registers---what registers do you need to save and restore to resume the interrupted code correctly? (Hint: it will be many).</li><li>Have <code>usertrap</code> save enough state in <code>struct proc</code> when the timer goes off that <code>sigreturn</code> can correctly return to the interrupted user code.</li><li>Prevent re-entrant calls to the handler----if a handler hasn't returned yet, the kernel shouldn't call it again. test2 tests this.</li></ul></blockquote><p>Debug:<br>已经完成了寄存器保存和恢复，寄存器保存位于 <code>trap.c</code> 的 <code>usertrap</code> 中，恢复位于 <code>proc.c</code> 的 <code>sys_sigreturn</code> 中。</p><h1 id="lab-copy-on-write-fork-for-xv6"><a class="anchor" href="#lab-copy-on-write-fork-for-xv6">#</a> Lab: Copy-on-Write Fork for xv6</h1><h2 id="reference"><a class="anchor" href="#reference">#</a> Reference</h2><ul><li><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUzMTExOTA1L2FydGljbGUvZGV0YWlscy8xMjEwMDA2MjA=">Lab6: Copy-on-Write Fork for xv6 详解</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzODQ1OTg4L2FydGljbGUvZGV0YWlscy8xMjYwNDU5NDM=">6.S081 lab 6: Copy-on-Write Fork for xv6</span></li></ul><h1 id="lab6-multithreading"><a class="anchor" href="#lab6-multithreading">#</a> Lab6： MultiThreading</h1><h2 id="reference-2"><a class="anchor" href="#reference-2">#</a> Reference</h2><ul><li><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L21hb3lsMDUwNi9hcnRpY2xlL2RldGFpbHMvMTI2NTQxNzA3">Lab:multithreading</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUzMTExOTA1L2FydGljbGUvZGV0YWlscy8xMjEwMzcyMTA=">Lab7: Multithreading</span></li></ul><h1 id="lab7-networking"><a class="anchor" href="#lab7-networking">#</a> Lab7: networking</h1><h2 id="reference-3"><a class="anchor" href="#reference-3">#</a> Reference</h2><ul><li><span class="exturl" data-url="aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vZHVpbGUvcC8xNjI3NzY0Ny5odG1s">duile:MIT6.S081-Lab7 Lab Networking [2021Fall]</span></li></ul><h1 id="lab8-locks"><a class="anchor" href="#lab8-locks">#</a> Lab8: Locks</h1><h2 id="reference-4"><a class="anchor" href="#reference-4">#</a> Reference</h2><ul><li><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDQ2NTQzNC9hcnRpY2xlL2RldGFpbHMvMTExNTczMTA0">xv6 6.S081 Lab7: Lock</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3UwMTM1Nzc5OTYvYXJ0aWNsZS9kZXRhaWxzLzExNDYzOTUxOQ==">Mit6.S081 - 实验 8-locks</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9qdWVqaW4uY24vcG9zdC83MDIxMjE4NTY4MjI2MjA5ODI4">[mit6.s081] 笔记 Lab8: Locks | 锁优化</span></li><li><span class="exturl" data-url="aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vZHVpbGUvcC8xNjM4OTE2NC5odG1sIyVFOCVCOCVBOSVFNSU5RCU5MQ==">duile: MIT6.S081-Lab8 Lock [2021Fall]</span></li></ul><p>无锁队列的理解？</p><ul><li><span class="exturl" data-url="aHR0cHM6Ly9jb29sc2hlbGwuY24vYXJ0aWNsZXMvODIzOS5odG1s">无锁队列的实现</span></li></ul><h1 id="lab9-file-system"><a class="anchor" href="#lab9-file-system">#</a> Lab9: File System</h1><h2 id="reference-5"><a class="anchor" href="#reference-5">#</a> Reference</h2><ul><li><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2ZhbnRhc3lfd3hlL2FydGljbGUvZGV0YWlscy84MTIwMTEy">yale_OS (7)——xv6 中的文件系统 (File System)</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3UwMTM1Nzc5OTYvYXJ0aWNsZS9kZXRhaWxzLzExNTcwNjA5Nz9zcG09MTAwMS4yMDE0LjMwMDEuNTUwMg==">Mit6.S081 - 实验 9-file system</span></li></ul><h1 id="lab10-mmap"><a class="anchor" href="#lab10-mmap">#</a> Lab10: mmap</h1><h2 id="reference-6"><a class="anchor" href="#reference-6">#</a> Reference</h2><ul><li><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDQ2NTQzNC9hcnRpY2xlL2RldGFpbHMvMTExNTg5MjQ0">xv6 6.S081 Lab9: mmap</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQwOTc3MTE4L2FydGljbGUvZGV0YWlscy8xMDgyNjIzNTY=">虚拟内存 MMU mmap</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3UwMTM1Nzc5OTYvYXJ0aWNsZS9kZXRhaWxzLzExNTk4NTUyNA==">Mit6.S081 - 实验 10-mmap</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0xvc3RVbnJhdmVsL2FydGljbGUvZGV0YWlscy8xMjE0MzczMjc=">[MIT 6.S081] Lab 10: mmap</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0tMWUFaV1MvYXJ0aWNsZS9kZXRhaWxzLzEyMTc2NDE2NA==">mmap 详解</span></li></ul><h1 id="reference-7"><a class="anchor" href="#reference-7">#</a> Reference</h1><ul><li><span class="exturl" data-url="aHR0cHM6Ly9wZG9zLmNzYWlsLm1pdC5lZHUvNi44MjgvMjAyMS9pbmRleC5odG1s">MIT 6.S081</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0cxMjk1NTgvYXJ0aWNsZS9kZXRhaWxzLzEyNjc3NDQxOQ==">MIT6.S081 lab util-xargs 的一种实现方法</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xod2hpdC9hcnRpY2xlL2RldGFpbHMvMTE2NDgyODA2">xv6 实验课程 -- 系统调用</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xod2hpdC9hcnRpY2xlL2RldGFpbHMvMTIwNDgxMzg1">xv6 实验课程 -- 页表</span></li><li><span class="exturl" data-url="aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vWXVhblppbWluZy9jYXRlZ29yeS8xOTA5NzA3Lmh0bWw=">YuanZiming: MIT-6.S081-2020 实验</span></li><li><span class="exturl" data-url="aHR0cHM6Ly94aWF5aW5ncC5naXRib29rLmlvL2J1aWxkX2Ffb3Mv">Learn OS with me</span></li><li><span class="exturl" data-url="aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vZGlhbmEtbGVhcm5pbmdjcHAvcC8xNTU3OTYyNi5odG1s">嘉然今天学 C++: MIT 6.S081 2021: Lab page tables</span></li><li><s><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL1Bva0lzZW1haW5lL29obXlmaXNoL3RyZWUvNDg5ZWViNjM1MmIxNTA1OWVhZDE4Nzg2ZWRmZjJhZTNkYzdiNGEzZS9kb2NzLyVFOCVBRiVCRSVFNSVBMCU4MiVFNCVCOSU4QiVFNSVBNCU5Ni9NSVQ2LlMwODE=">ohmyfish: MIT6.S081</span></s></li><li><span class="exturl" data-url="aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vd2VpanVuamkvcC8xNDMzODQ2Ni5odG1s">XV6 学习（6）Lab: traps</span></li><li><span class="exturl" data-url="aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC81MTIzNTM2NDQ=">LAB4：Traps 及 xv6 中断相关源码理解</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUzMTExOTA1L2FydGljbGUvZGV0YWlscy8xMjA5OTY0NDY=">Lab4: traps</span></li><li><span class="exturl" data-url="aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vZGlhbmEtbGVhcm5pbmdjcHAvcC8xNTU3OTYzNC5odG1s">嘉然今天 C++: Traps</span></li><li><span class="exturl" data-url="aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vd2VpanVuamkvcC94djYtc3R1ZHktOS5odG1s">XV6 学习（9）Lab cow: Copy-on-write fork</span></li></ul></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i> </span><span class="text">更新于</span> <time title="修改时间：2022-11-19 17:01:45" itemprop="dateModified" datetime="2022-11-19T17:01:45+08:00">2022-11-19</time></span></div><div class="reward"><button><i class="ic i-heartbeat"></i> 赞赏</button><p>请我喝[茶]~(￣▽￣)~*</p><div id="qr"><div><img data-src="/images/wechatpay.png" alt="澹台千儿 微信支付"><p>微信支付</p></div><div><img data-src="/images/alipay.png" alt="澹台千儿 支付宝"><p>支付宝</p></div><div><img data-src="/images/paypal.png" alt="澹台千儿 贝宝"><p>贝宝</p></div></div></div><div id="copyright"><ul><li class="author"><strong>本文作者： </strong>澹台千儿 <i class="ic i-at"><em>@</em></i>澹台千儿</li><li class="link"><strong>本文链接：</strong> <a href="http://tantaiqianer.github.io/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E8%AF%BE%E8%AE%BE%E6%80%BB%E7%BB%93/" title="操作系统课设总结">http://tantaiqianer.github.io/操作系统/操作系统课设总结/</a></li><li class="license"><strong>版权声明： </strong>本站所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> 许可协议。转载请注明出处！</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A/%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A4-%E7%89%9B%E9%A1%BF%E6%B3%95/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;img.timelessq.com&#x2F;image&#x2F;Z15" title="机器学习实验报告(4)：牛顿法求解对数概率回归"><span class="type">上一篇</span> <span class="category"><i class="ic i-flag"></i> 实验报告</span><h3>机器学习实验报告(4)：牛顿法求解对数概率回归</h3></a></div><div class="item right"><a href="/%E7%BB%8F%E6%B5%8E%E5%AD%A6/%E8%AE%A1%E9%87%8F%E7%BB%8F%E6%B5%8E%E5%AD%A6/%E8%AE%A1%E9%87%8F%E7%BB%8F%E6%B5%8E%E5%AD%A6%E7%AC%94%E8%AE%B04%EF%BC%9A%E6%94%BE%E5%AE%BD%E5%9F%BA%E6%9C%AC%E5%81%87%E5%AE%9A%E7%9A%84%E6%A8%A1%E5%9E%8B/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;img.timelessq.com&#x2F;image&#x2F;CES5" title="计量经济学笔记(4)：放宽基本假定的模型"><span class="type">下一篇</span> <span class="category"><i class="ic i-flag"></i> 计量经济学</span><h3>计量经济学笔记(4)：放宽基本假定的模型</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="文章目录"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%A6%82%E8%BF%B0"><span class="toc-number">1.</span> <span class="toc-text">概述</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#lab-xv6-and-unix-utilities"><span class="toc-number">2.</span> <span class="toc-text">Lab: Xv6 and Unix utilities</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#sleep-easy"><span class="toc-number">2.1.</span> <span class="toc-text">sleep (easy)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#xargs-moderate"><span class="toc-number">2.2.</span> <span class="toc-text">xargs (moderate)</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#lab-system-calls"><span class="toc-number">3.</span> <span class="toc-text">Lab: system calls</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#system-call-tracing"><span class="toc-number">3.1.</span> <span class="toc-text">System call tracing</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#sysinfo"><span class="toc-number">3.2.</span> <span class="toc-text">Sysinfo</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#lab-page-tables"><span class="toc-number">4.</span> <span class="toc-text">Lab: page tables</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#speed-up-system-calls-easy"><span class="toc-number">4.1.</span> <span class="toc-text">Speed up system calls (easy)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#print-a-page-table-easy"><span class="toc-number">4.2.</span> <span class="toc-text">Print a page table (easy)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#detecting-which-pages-have-been-accessed-hard"><span class="toc-number">4.3.</span> <span class="toc-text">Detecting which pages have been accessed (hard)</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#lab-traps"><span class="toc-number">5.</span> <span class="toc-text">Lab: Traps</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#alarmhard"><span class="toc-number">5.1.</span> <span class="toc-text">Alarm(hard)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#test0-invoke-handler"><span class="toc-number">5.1.1.</span> <span class="toc-text">Test0 invoke handler</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#test1test2-resume-interrupted-code"><span class="toc-number">5.1.2.</span> <span class="toc-text">Test1&#x2F;test2(): resume interrupted code</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#lab-copy-on-write-fork-for-xv6"><span class="toc-number">6.</span> <span class="toc-text">Lab: Copy-on-Write Fork for xv6</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#reference"><span class="toc-number">6.1.</span> <span class="toc-text">Reference</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#lab6-multithreading"><span class="toc-number">7.</span> <span class="toc-text">Lab6： MultiThreading</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#reference-2"><span class="toc-number">7.1.</span> <span class="toc-text">Reference</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#lab7-networking"><span class="toc-number">8.</span> <span class="toc-text">Lab7: networking</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#reference-3"><span class="toc-number">8.1.</span> <span class="toc-text">Reference</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#lab8-locks"><span class="toc-number">9.</span> <span class="toc-text">Lab8: Locks</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#reference-4"><span class="toc-number">9.1.</span> <span class="toc-text">Reference</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#lab9-file-system"><span class="toc-number">10.</span> <span class="toc-text">Lab9: File System</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#reference-5"><span class="toc-number">10.1.</span> <span class="toc-text">Reference</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#lab10-mmap"><span class="toc-number">11.</span> <span class="toc-text">Lab10: mmap</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#reference-6"><span class="toc-number">11.1.</span> <span class="toc-text">Reference</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#reference-7"><span class="toc-number">12.</span> <span class="toc-text">Reference</span></a></li></ol></div><div class="related panel pjax" data-title="系列文章"><ul><li><a href="/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E8%AF%BE%E5%A0%82%E7%AC%94%E8%AE%B0/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F1%EF%BC%9A%E6%A6%82%E5%BF%B5%E5%92%8C%E5%89%8D%E7%BD%AE%E7%9F%A5%E8%AF%86/" rel="bookmark" title="操作系统(1)：概念和前置知识">操作系统(1)：概念和前置知识</a></li><li><a href="/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E8%AF%BE%E5%A0%82%E7%AC%94%E8%AE%B0/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F2%EF%BC%9A%E8%BF%9B%E7%A8%8B%E7%AE%A1%E7%90%86/" rel="bookmark" title="操作系统(2)：进程管理">操作系统(2)：进程管理</a></li><li><a href="/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E8%AF%BE%E5%A0%82%E7%AC%94%E8%AE%B0/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F3%EF%BC%9A%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86/" rel="bookmark" title="操作系统(3)：内存管理">操作系统(3)：内存管理</a></li><li><a href="/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E8%AF%BE%E5%A0%82%E7%AC%94%E8%AE%B0/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F4%EF%BC%9A%E6%96%87%E4%BB%B6%E7%AE%A1%E7%90%86/" rel="bookmark" title="操作系统(4)：文件系统">操作系统(4)：文件系统</a></li><li><a href="/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%A6%82%E5%BF%B5%E6%80%BB%E7%BB%93/" rel="bookmark" title="操作系统概念总结">操作系统概念总结</a></li><li><a href="/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E8%AF%BE%E5%A0%82%E7%AC%94%E8%AE%B0/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F5%EF%BC%9A%E8%AE%BE%E5%A4%87%E7%AE%A1%E7%90%86/" rel="bookmark" title="操作系统(5)：设备管理">操作系统(5)：设备管理</a></li><li class="active"><a href="/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E8%AF%BE%E8%AE%BE%E6%80%BB%E7%BB%93/" rel="bookmark" title="操作系统课设总结">操作系统课设总结</a></li><li><a href="/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E8%AF%BE%E8%AE%BE%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A/" rel="bookmark" title="操作系统实验报告">操作系统实验报告</a></li><li><a href="/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E8%BF%90%E8%A1%8C%E6%97%B6%E7%B3%BB%E7%BB%9F/" rel="bookmark" title="运行时系统">运行时系统</a></li></ul></div><div class="overview panel" data-title="站点概览"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="澹台千儿" data-src="/images/avatar.jpg"><p class="name" itemprop="name">澹台千儿</p><div class="description" itemprop="description"></div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">236</span> <span class="name">文章</span></a></div><div class="item categories"><a href="/categories/"><span class="count">77</span> <span class="name">分类</span></a></div><div class="item tags"><a href="/tags/"><span class="count">2</span> <span class="name">标签</span></a></div></nav><div class="social"><span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL1RhbnRhaVFpYW5lcg==" title="https:&#x2F;&#x2F;github.com&#x2F;TantaiQianer"><i class="ic i-github"></i></span> <span class="exturl item twitter" data-url="aHR0cHM6Ly90d2l0dGVyLmNvbS95b3VybmFtZQ==" title="https:&#x2F;&#x2F;twitter.com&#x2F;yourname"><i class="ic i-twitter"></i></span> <span class="exturl item zhihu" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3Blb3BsZS9saXUtbGlhbmctMzItOTQ=" title="https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;liu-liang-32-94"><i class="ic i-zhihu"></i></span> <span class="exturl item music" data-url="aHR0cHM6Ly9tdXNpYy4xNjMuY29tLyMvdXNlci9ob21lP2lkPXlvdXJpZA==" title="https:&#x2F;&#x2F;music.163.com&#x2F;#&#x2F;user&#x2F;home?id&#x3D;yourid"><i class="ic i-cloud-music"></i></span> <span class="exturl item weibo" data-url="aHR0cHM6Ly93ZWliby5jb20veW91cm5hbWU=" title="https:&#x2F;&#x2F;weibo.com&#x2F;yourname"><i class="ic i-weibo"></i></span> <span class="exturl item about" data-url="aHR0cHM6Ly9hYm91dC5tZS95b3VybmFtZQ==" title="https:&#x2F;&#x2F;about.me&#x2F;yourname"><i class="ic i-address-card"></i></span></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>首页</a></li><li class="item"><a href="/about/" rel="section"><i class="ic i-user"></i>关于</a></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-feather"></i>文章</a><ul class="submenu"><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>归档</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>分类</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>标签</a></li></ul></li><li class="item"><a href="/friends/" rel="section"><i class="ic i-heart"></i>friends</a></li></ul></div></div></div><ul id="quick"><li class="prev pjax"><a href="/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A/%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A4-%E7%89%9B%E9%A1%BF%E6%B3%95/" rel="prev" title="上一篇"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/%E7%BB%8F%E6%B5%8E%E5%AD%A6/%E8%AE%A1%E9%87%8F%E7%BB%8F%E6%B5%8E%E5%AD%A6/%E8%AE%A1%E9%87%8F%E7%BB%8F%E6%B5%8E%E5%AD%A6%E7%AC%94%E8%AE%B04%EF%BC%9A%E6%94%BE%E5%AE%BD%E5%9F%BA%E6%9C%AC%E5%81%87%E5%AE%9A%E7%9A%84%E6%A8%A1%E5%9E%8B/" rel="next" title="下一篇"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>随机文章</h2><ul><li class="item"><div class="breadcrumb"><a href="/categories/%E6%95%B0%E5%AD%A6/" title="分类于 数学">数学</a> <i class="ic i-angle-right"></i> <a href="/categories/%E6%95%B0%E5%AD%A6/%E6%95%B0%E5%80%BC%E5%88%86%E6%9E%90/" title="分类于 数值分析">数值分析</a></div><span><a href="/%E6%95%B0%E5%80%BC%E5%88%86%E6%9E%90/1%20%E5%8D%95%E5%8F%98%E5%85%83%E6%96%B9%E7%A8%8B%E6%B1%82%E8%A7%A3/" title="单变元方程求解">单变元方程求解</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA/" title="分类于 计算机">计算机</a> <i class="ic i-angle-right"></i> <a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA/%E7%AE%97%E6%B3%95%E4%B8%8E%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" title="分类于 算法与数据结构">算法与数据结构</a> <i class="ic i-angle-right"></i> <a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA/%E7%AE%97%E6%B3%95%E4%B8%8E%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" title="分类于 数据结构">数据结构</a></div><span><a href="/%E7%AE%97%E6%B3%95%E4%B8%8E%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E5%B9%B6%E6%9F%A5%E9%9B%86/" title="并查集">并查集</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E8%8B%B1%E8%AF%AD/" title="分类于 英语">英语</a></div><span><a href="/%E8%8B%B1%E8%AF%AD/TOFFL%20%E5%8F%A3%E8%AF%AD%E7%AC%94%E8%AE%B0/" title="TOFFL 口语笔记">TOFFL 口语笔记</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E6%95%B0%E5%AD%A6/" title="分类于 数学">数学</a> <i class="ic i-angle-right"></i> <a href="/categories/%E6%95%B0%E5%AD%A6/%E6%8B%93%E6%89%91/" title="分类于 拓扑">拓扑</a> <i class="ic i-angle-right"></i> <a href="/categories/%E6%95%B0%E5%AD%A6/%E6%8B%93%E6%89%91/%E7%82%B9%E9%9B%86%E6%8B%93%E6%89%91/" title="分类于 点集拓扑">点集拓扑</a></div><span><a href="/%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80/%E6%8B%93%E6%89%91%E5%AD%A6/%E7%82%B9%E9%9B%86%E6%8B%93%E6%89%91%E7%AC%94%E8%AE%B0/" title="点集拓扑笔记(1)：点集拓扑的基本概念">点集拓扑笔记(1)：点集拓扑的基本概念</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E6%9C%9F%E6%9C%AB%E9%87%8D%E7%82%B9/" title="未命名">未命名</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA/" title="分类于 计算机">计算机</a> <i class="ic i-angle-right"></i> <a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA/%E7%AE%97%E6%B3%95%E4%B8%8E%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" title="分类于 算法与数据结构">算法与数据结构</a></div><span><a href="/%E7%AE%97%E6%B3%95%E4%B8%8E%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E7%AE%97%E6%B3%95%E7%9A%84%E6%8F%8F%E8%BF%B0%E8%AE%B0%E5%8F%B7/" title="算法的描述记号">算法的描述记号</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA/" title="分类于 计算机">计算机</a> <i class="ic i-angle-right"></i> <a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/" title="分类于 机器学习">机器学习</a></div><span><a href="/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E7%9F%A9%E9%98%B5%E5%88%86%E8%A7%A3%E6%80%BB%E7%BB%93/" title="矩阵分解(Matrix Factorization)总结">矩阵分解(Matrix Factorization)总结</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA/" title="分类于 计算机">计算机</a> <i class="ic i-angle-right"></i> <a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA/%E7%BD%91%E7%BB%9C/" title="分类于 网络">网络</a></div><span><a href="/%E7%BD%91%E7%BB%9C/%E4%B8%89%E7%BA%A7%E7%BD%91%E7%BB%9C%E6%8A%80%E6%9C%AF/" title="三级网络技术笔记">三级网络技术笔记</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80/%E4%BB%A3%E6%95%B0%E6%8B%93%E6%89%91/Hatch%E7%AC%94%E8%AE%B0/" title="未命名">未命名</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E7%94%B3%E8%AF%B7/" title="分类于 申请">申请</a></div><span><a href="/%E5%85%B3%E4%BA%8E%E7%94%B3%E8%AF%B7%E9%82%A3%E4%BA%9B%E4%BA%8B/%E6%8E%A8%E8%8D%90%E4%BF%A1/" title="关于推荐信的一些知识">关于推荐信的一些知识</a></span></li></ul></div><div><h2>最新评论</h2><ul class="leancloud-recent-comment"></ul></div></div><div class="status"><div class="copyright">&copy; 2021 – <span itemprop="copyrightYear">2023</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">澹台千儿 @ Tantai Qianer</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i> </span><span title="站点总字数">525k 字</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="ic i-coffee"></i> </span><span title="站点阅读时长">7:57</span></div><div class="powered-by">基于 <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"操作系统/操作系统课设总结/",favicon:{show:"（●´3｀●）やれやれだぜ",hide:"(´Д｀)大変だ！"},search:{placeholder:"文章搜索",empty:"关于 「 ${query} 」，什么也没搜到",stats:"${time} ms 内找到 ${hits} 条结果"},valine:!0,fancybox:!0,copyright:'复制成功，转载请遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 协议。',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/js/app.js?v=0.2.5"></script></body></html>